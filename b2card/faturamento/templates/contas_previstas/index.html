<meta charset="utf-8">
{% extends "base_page.html" %}

{% block script %}
	<script src="/static/js/apps/faturamento/contasreceber/contasreceber.js"></script>
	<script src="/static/js/apps/faturamento/contasreceber/contasreceber-service.js"></script>
	<script src="/static/js/apps/cadastros/pessoa/pessoa-services.js"></script>
	<script src="/static/js/apps/demandas/demandas-services.js"></script>
	<script src="/static/js/apps/faturamento/parcela.js"></script>
	<script src="/static/js/apps/faturamento/parcela-services.js"></script>
	<script src="/static/js/apps/cadastros/valorhora/valorhora-services.js"></script>
	<script src="/static/js/commons/commons.js"></script>
	<script src="/static/js/angular/ui-bootstrap-tpls-2.2.0.min.js"></script>
	<script src="/static/js/jquery/priceformat/jquery.priceformat.min.js"></script>
{% endblock %}



{%block content%}

<style>

button.margin {
	margin-top: 21px
}

.app-modal-window .modal-dialog {
	  width: 100%;
	  height: 100%;
	  margin: 0;
	  padding: 0;
	}
	.modal-content {
	  height: auto;
	  min-height: 100%;
	  border-radius: 0;
	}

</style>

{%verbatim%}

<div ng-app="contasreceber" class="ng-hide" ng-show="$ctrl.show" ng-controller="ContasReceberController as $ctrl">

	<div class="alert alert-danger" ng-show="$ctrl.messagem">
		 {{$ctrl.messagem}}
	</div>
	
	<div class="panel panel-primary form-group-sm">
		<div class="panel-body">
			<form name="arguments">
				<div class="form-group">
					<label for="cliente">Cliente</label>
					<select type="text" id="cliente" name="cliente" ng-model="$ctrl.arguments.cliente_id" class="form-control" ng-options="c.id as c.pessoa.nome_razao_social for c in $ctrl.listaclientes">
						<option value="">Selecione...</option>
					</select>
				</div>
				<button type="button" class="btn btn-sm btn-default margin" ng-click="$ctrl.pesquisar();">Pesquisar</button>
			</form>
		</div>
	</div>
	
	<div class="col-sm-6">
	<table class="table table-sm">
		<thead>
			<tr>
				<th>Cliente</th>
				<th>Demanda</th>
				<th>Data</th>
				<th></th>
				<th>Total</th>
			</tr>
		</thead>
		<tbody>
			<tr ng-repeat="contareceber in $ctrl.resultados" ng-click="$ctrl.abrircontasreceber(contareceber);">
				<td>
					{{contareceber.demanda.cliente.razao_social}}
				</td>
				<td>
					{{contareceber.demanda.nome_demanda}}
				</td>
				<td>
					{{contareceber.data_previsto_parcela}}
				</td>
				<td>
					<table class="table table-sm">	
						<thead>
							<tr>
								<th>
									Fase
								</th>
								<th>
									Valor
								</th>
							</tr>					
						<tbody>
							<tr ng-repeat="parcelafase in contareceber.parcelafases">
								<td>
									{{parcelafase.fase.descricao}}
								</td>
								<td>
									{{parcelafase.valor}}
								</td>
							</tr>
						</tbody>
					</table>
				</td>
				<td>
					{{contareceber.valor_parcela}}
				</td>
			</tr>
		</tbody>
	</table>
	</div>
	<div class="col-sm-6">
		<table class="table table-sm">
			<thead>
				<tr>
					<th></th>
					<th>Nome do cliente</th>
					<th>Parcela</th>
					<th>Dt.Prev.Fat</th>
					<th>Fase</th>
					<th>Perfil</th>
					<th>Horas</th>
					<th>Valor</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>
						<div class="glyphicon glyphicon-remove" style="cursor: pointer;" ng-click="$ctrl.removeritemfaturamento();"></div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

{%endverbatim%}

{%endblock%}