<meta charset="utf-8">
{% extends "base_page.html" %}


{% block script %}
	<script src="/static/js/apps/gestor/gestor.js"></script>
	<script src="/static/js/apps/gestor/gestor-services.js"></script>
	<script src="/static/js/apps/cadastros/tipoalocacao/tipoalocacao-services.js"></script>
	
	<script type="text/javascript">
	  	angular.bootstrap(document.getElementById('gestor'), ['gestor']);
  	</script>
{% endblock %}


{% block content %}

{%verbatim%}

<style>
	div.atividade {
		border-top-color: white;
		height: 22px;
		vertical-align: middle;
		line-height: 20px;
	}

	.table>tbody>tr>td {
		margin: 0;
		padding: 0
	}
	
	button.expandir {
		width: 18px;
	    padding: 0;
	    margin: 0;
	    height: 17px;
	    line-height: 1.4
	}
	
	div.panel_body_atividades {
		padding-top: 0;
    	padding-bottom: 0;
	}
	
</style>

<div id="gestor" class="margin-top ng-hide" ng-controller="GestorController as $ctrl" ng-show="$ctrl.show">
	<fieldset ng-repeat="cliente in $ctrl.clientes">
		<legend>{{cliente.nome_fantasia}}</legend>
		<div class="panel panel-default" style="margin-bottom: 5px; margin-top: 0px;">
			<div class="panel-heading" style="height: 22px; padding:2px; font-style: italic;">
				<div class="col-sm-1" style="width: 1px;"></div>
				<div class="col-sm-5"><strong>Demanda</strong></div>
				<div class="col-sm-2"><strong>Código no cliente</strong></div>
				<div class="col-sm-2"><strong>Status</strong></div>
			</div>
		</div>
		<div class="panel panel-default" style="margin-bottom: 0px; margin-top: 0px;" ng-repeat="demanda in cliente.demandas">
				<div class="panel-heading" style="height: 22px; padding:2px">
					<div class="col-sm-1" style="width: 1px;">
						<button type="button" class="btn btn-sm btn-default expandir" ng-click="$ctrl.expandir(demanda);">{{!$ctrl.demandamap[demanda.$$hashKey].expandir ? '+' : '-'}}</button>
					</div>
					<div class="col-sm-5">{{demanda.id}} - {{demanda.nome_demanda}}</div>
					<div class="col-sm-2">{{demanda.codigo_demanda}}</div>
					<div class="col-sm-2">
						{{demanda.status_demanda == 'O' ? 'Em orçamentação' : ''}}
						{{demanda.status_demanda == 'A' ? 'Aguardando aprovação' : ''}}
						{{demanda.status_demanda == 'N' ? 'Não aprovada' : ''}}
						{{demanda.status_demanda == 'C' ? 'Cancelada' : ''}}
						{{demanda.status_demanda == 'H' ? 'Em homologação' : ''}}
						{{demanda.status_demanda == 'I' ? 'Implantada' : ''}}
						{{demanda.status_demanda == 'D' ? 'Em desenvolvimento' : ''}}
					</div>
				</div>
				<div class="panel-body" style="margin: 0 0 0 50px; padding: 0 0 0 0;" ng-show="$ctrl.demandamap[demanda.$$hashKey].expandir">
					<div class="panel panel-default" style="margin-bottom: 5px; margin-top: 5px;">
						<div class="panel-heading" style="height: 22px; padding:2px; font-style: italic;">
							<div class="col-sm-12">
								<div class="col-sm-2">Fase</div>
								<div class="col-sm-2">Data inicio</div>
								<div class="col-sm-2">Data fim</div>
								<div class="col-sm-2" style="text-align: center;">% Conclusão</div>
							</div>
						</div>
					</div>
					<div class="panel panel-default" style="margin-bottom: 5px; margin-top: 0px;">
						<div class="panel-body panel_body_atividades">
							<div ng-repeat="fase_atividade in demanda.fase_atividades">
								<div class="row fase_atividade" style="border-top: 1px #ddd solid;">
									<div class="row" style="margin-bottom: 5px; margin-left: 0;">
										<div class="col-sm-2">{{fase_atividade.fase.descricao}}</div>
										<div class="col-sm-2">{{fase_atividade.data_inicio}}</div>
										<div class="col-sm-2">{{fase_atividade.data_fim}}</div>
										<div class="col-sm-2" style="text-align: center;">{{fase_atividade.percentual_concluido}}</div>
									</div>
									<div class="row" style="margin-left: 18%;">
										<div class="col-sm-10">
											<div class="row">
												<div class="row cabecalho_atividade">
													<div class="col-sm-10" style="width: 70%"><div class="atividade">Atividade</div></div>
													<div class="col-sm-1" style="width: 12.6%"><div class="atividade">Data inicio</div></div>
													<div class="col-sm-1" style="width: 9%"><div class="atividade" >Data fim</div></div>
													<div class="col-sm-1"><div class="atividade" style="text-align: center;">%</div></div>
												</div>
											</div>
											<div class="row" style="border-top: 1px #ddd solid; margin-top: -1px;" ng-repeat="atividade in fase_atividade.atividades">
												<div class="row">
													<div class="col-sm-10" style="width: 70%"><div class="atividade">{{atividade.descricao}}</div></div>
													<div class="col-sm-1" style="width: 12.6%"><div class="atividade">{{atividade.data_inicio}}</div></div>
													<div class="col-sm-1" style="width: 9%"><div class="atividade" >{{atividade.data_fim}}</div></div>
													<div class="col-sm-1"><div class="atividade" style="text-align: center;">{{atividade.percentual_concluido}}</div></div>
												</div>
												<div class="row" style="padding-left: 74px">
													<div class="panel panel-default" style="margin-bottom: 0">
														<div class="panel-heading" style="height: 22px; padding:2px; font-style: italic;">
															<div class="col-sm-8">
																Profissional
															</div>
															<div class="col-sm-1" style="width: 14.4%; text-align: center;">
																Horas previstas
															</div>
															<div class="col-sm-1" style="width: 14.5%; text-align: center;">
																Horas alocadas
															</div>
															<div class="col-sm-1" style="text-align: center; width: 1%">
																%
															</div>
														</div>
													</div>
												</div>
												<div class="row" style="padding-left: 82px; padding-right:23px;" ng-repeat="atividade_profissional in atividade.atividadeprofissionais">
													<div class="col-sm-8">
														{{atividade_profissional.pessoa_fisica.pessoa.nome_razao_social}}
													</div>
													<div class="col-sm-1" style="width: 16%; text-align: center;">
														{{atividade_profissional.quantidade_horas_formatada}}
													</div>
													<div class="col-sm-1" style="width: 15%; text-align: center;">
														{{atividade_profissional.horas_alocadas}}
													</div>
													<div class="col-sm-1" style="text-align: center; width:1%; padding: 0 0 0 13px">
														{{atividade_profissional.percentual_concluido}}
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</fieldset>
</div>

{%endverbatim%}

{% endblock %}