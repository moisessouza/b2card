<meta charset="utf-8">
{% extends "base_page.html" %}

{% block script %}
	<script src="/static/js/apps/demandas/pesquisa.js"></script>
	<script src="/static/js/apps/demandas/pesquisa-services.js"></script>
	<script src="/static/js/apps/cadastros/pessoa/pessoa-services.js"></script>
	<script src="/static/js/commons/commons.js"></script>
	<script src="/static/js/angular/ui-bootstrap-tpls-2.2.0.min.js"></script>
	<script src="/static/js/jquery/priceformat/jquery.priceformat.min.js"></script>
	
	<script type="text/javascript">
	  	angular.bootstrap(document.getElementById('pesquisademanda'), ['pesquisademanda']);
  	</script>
	
{% endblock %}

{% block content %}

<style>
table tr {
    cursor: pointer;
}

button.margin {
	margin-top: 21px
}

</style>

{%verbatim%}

<div id="pesquisademanda" ng-controller="PesquisaDemandaController as $ctrl" class="ng-hide" ng-show="$ctrl.show">
	<div class="panel panel-primary form-group-sm">
		<div class="panel-body">
			<form name="arguments">
				<div class="col-sm-1">
					<div class="form-group">
						<label for="total_orcamento">Demanda ID</label>
						<input type="number" ng-model="$ctrl.arguments.demanda_id" class="form-control"/>
					</div>
				</div>
				<div class="col-sm-5">
					<div class="form-group">
						<label for="total_orcamento">Descrição</label>
						<input type="text" ng-model="$ctrl.arguments.palavra_chave" class="form-control"/>
					</div>
				</div>
				<div class="col-sm-2">
					<div class="form-group">
						<label for="cliente">Cliente</label>
						<select id="cliente" name="cliente" ng-model="$ctrl.arguments.cliente_id" class="form-control" ng-options="c.id as c.pessoa.nome_razao_social for c in $ctrl.listaclientes">
							<option value="">Selecione...</option>
						</select>
					</div>
				</div>
				<button class="btn btn-sm btn-default margin" ng-click="$ctrl.pesquisar();">Pesquisar</button>
				<button class="btn btn-sm btn-default margin" ng-click="$ctrl.novo();" value="Novo">Novo</button>
			</form>
		</div>
	</div>

	<table class="table table-hover">
	    <thead>
	      <tr>
	        <th>Demanda</th>
	        <th>Cliente</th>
	        <th>Código da demanda</th>
	        <th>Responsável</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr ng-click="$ctrl.abrirdemanda(demanda)" ng-repeat="demanda in $ctrl.resultado.demandas">
	      	<td>{{demanda.nome_demanda}}
	        <td>{{demanda.cliente.pessoa.nome_razao_social}}</td>
	        <td>{{demanda.codigo_demanda}}</td>
	        <td>{{demanda.responsavel.pessoa.nome_razao_social}}</td>
	      </tr>
	    </tbody>
	</table>
	<div class="col-sm-1">
		<div class="form-group">
			<label>Página</label>
			<select type="text" ng-model="$ctrl.arguments.pagina" ng-change="$ctrl.pesquisar()" class="form-control">
				<option ng-repeat="i in [].constructor($ctrl.resultado.total_paginas) track by $index" value="{{$index + 1}}">{{$index + 1}}</option>
			</select>
		</div>
	</div>
</div>
 
 {%endverbatim%} 
 
{% endblock %}